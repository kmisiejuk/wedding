"use strict";function _createForOfIteratorHelper(e,n){var t,r,o,a,l="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(l)return r=!(t=!0),{s:function(){l=l.call(e)},n:function(){var e=l.next();return t=e.done,e},e:function(e){r=!0,o=e},f:function(){try{t||null==l.return||l.return()}finally{if(r)throw o}}};if(Array.isArray(e)||(l=_unsupportedIterableToArray(e))||n&&e&&"number"==typeof e.length)return l&&(e=l),a=0,{s:n=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,n){var t;if(e)return"string"==typeof e?_arrayLikeToArray(e,n):"Map"===(t="Object"===(t=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,n):void 0}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var currentImageIndex,gallery=document.getElementById("gallery"),showGalleryBtn=document.getElementById("showGallerybtn"),THUMBNAILS_CONTAINER=document.querySelector(".gallery__thumbnails-list"),POPUP_GALLERY_CONTAINER=document.querySelector(".popup__swiper-wrapper"),GALLERY_POPUP=document.querySelector(".popup__gallery"),THUMBNAILS=document.querySelectorAll(".gallery__thumbnails-img-item"),CLOSE_GALLERY=document.querySelector(".popup__gallery-btn-close"),prevImgBtn=document.querySelector(".prev-img-btn"),nextImgBtn=document.querySelector(".next-img-btn"),downloadBtn=document.querySelector(".download-btn"),downloadAllBtn=document.querySelector(".gallery__btn-download-all"),imagesArray=[],showGallery=function(e){e.preventDefault(),gallery.classList.add("show-gallery"),gallery.scrollIntoView({behavior:"smooth"}),window.scrollBy(0,window.innerHeight)},openPopup=(showGalleryBtn.addEventListener("click",showGallery),function(){document.body.style.overflow="hidden",GALLERY_POPUP.classList.add("show-popup"),showImageByIndex(currentImageIndex)}),closePopup=function(){document.body.style.overflow="auto",GALLERY_POPUP.classList.add("fade-out"),setTimeout(function(){GALLERY_POPUP.classList.remove("show-popup"),GALLERY_POPUP.classList.remove("fade-out"),POPUP_GALLERY_CONTAINER.innerHTML=""},300)},addItemToGallery=(THUMBNAILS.forEach(function(e,n){e.addEventListener("click",function(e){currentImageIndex=n,openPopup()})}),CLOSE_GALLERY.addEventListener("click",closePopup),function(e){POPUP_GALLERY_CONTAINER.appendChild(e)}),showImageByIndex=function(e){POPUP_GALLERY_CONTAINER.innerHTML="";var n=document.createElement("img");n.src=imagesArray[e].src,n.classList.add("popup__swiper-img"),prevImgBtn.classList.add("prev-img-btn","img-btn"),nextImgBtn.classList.add("next-img-btn","img-btn"),addItemToGallery(prevImgBtn),addItemToGallery(nextImgBtn),addItemToGallery(n)},prevImg=function(e){currentImageIndex=(currentImageIndex-1+imagesArray.length)%imagesArray.length,showImageByIndex(currentImageIndex)},nextImg=function(){currentImageIndex=(currentImageIndex+1)%imagesArray.length,showImageByIndex(currentImageIndex)},startX=(prevImgBtn.addEventListener("click",prevImg),nextImgBtn.addEventListener("click",nextImg),document.body.addEventListener("keydown",function(e){"ArrowLeft"===e.key?prevImg():"ArrowRight"===e.key?nextImg():"Escape"===e.key?closePopup():"Enter"===e.key&&openPopup()}),null),MODAL_CONFIRM=(POPUP_GALLERY_CONTAINER.addEventListener("touchstart",function(e){startX=e.touches[0].clientX}),POPUP_GALLERY_CONTAINER.addEventListener("touchmove",function(e){startX&&(10<(e=e.touches[0].clientX-startX)?prevImg():e<-10&&nextImg())}),POPUP_GALLERY_CONTAINER.addEventListener("touchend",function(){startX=null}),document.querySelector(".modal__confirm")),showConfirm=function(){MODAL_CONFIRM.classList.add("modal__confirm-active"),setTimeout(hideConfirm,1e3)},hideConfirm=function(){MODAL_CONFIRM.classList.remove("modal__confirm-active")},uploadForm=document.getElementById("uploadForm"),fileInput=uploadForm.querySelector('input[type="file"]'),downloadCurrentImage=(uploadForm.addEventListener("submit",function(e){e.preventDefault();var n,t=_createForOfIteratorHelper(fileInput.files);try{for(t.s();!(n=t.n()).done;){var r=n.value,o=new FileReader;o.onload=function(e){var e=e.target.result,n=document.createElement("img");n.classList.add("gallery__thumbnails-img-item"),n.src=e,n.alt="Magiczne Chwile image ".concat(imagesArray.length),THUMBNAILS_CONTAINER.appendChild(n),n.addEventListener("click",function(){currentImageIndex=imagesArray.indexOf(n),openPopup()}),imagesArray.push(n),showAllDownloadBtn()},o.readAsDataURL(r)}}catch(e){t.e(e)}finally{t.f()}showConfirm(),fileInput.value=""}),function(){var e,n=POPUP_GALLERY_CONTAINER.querySelector(".popup__swiper-img"),t="Magiczne Chwile image ".concat(currentImageIndex);n&&n.src?((e=document.createElement("a")).href=n.src,e.download="".concat(t,".jpg"),e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)):console.error("Nie można pobrać obecnego obrazu - brak obrazu lub adres URL.")}),downloadGalleryAsZip=(downloadBtn.addEventListener("click",downloadCurrentImage),function(){var t=new JSZip;imagesArray.forEach(function(e,n){n="image_".concat(n+1,".jpg"),e=e.src.replace(/^data:image\/(png|jpg|jpeg);base64,/,"");t.file(n,e,{base64:!0})}),t.generateAsync({type:"blob"}).then(function(e){saveAs(e,"Magiczne_Chwile_galeria.zip")}).catch(function(e){console.error("Wystąpił błąd podczas generowania pliku ZIP:",e)})}),openInfoBtn=(downloadAllBtn.addEventListener("click",downloadGalleryAsZip),document.querySelector("#infoBtn")),openScheduleBtn=document.querySelector("#scheduleBtn"),buttonsArray=[fileInput,uploadForm,showGalleryBtn,downloadAllBtn,openInfoBtn,openScheduleBtn],showAllDownloadBtn=(buttonsArray.forEach(function(e){GALLERY_POPUP.classList.contains("show-popup")?e.setAttribute("tabindex","-1"):e.setAttribute("tabindex","0")}),function(){0<imagesArray.length?downloadAllBtn.style.display="flex":downloadAllBtn.style.display="none",showGalleryInfo()}),showGalleryInfo=function(e){var n=document.querySelector(".gallery__info");imagesArray.length<=0?n.style.display="block":n.style.display="none"};showGalleryInfo();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdhbGxlcnkuanMiXSwibmFtZXMiOlsiQ0xPU0VfR0FMTEVSWSIsImdhbGxlcnkiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic2hvd0dhbGxlcnlCdG4iLCJUSFVNQk5BSUxTX0NPTlRBSU5FUiIsInF1ZXJ5U2VsZWN0b3IiLCJQT1BVUF9HQUxMRVJZX0NPTlRBSU5FUiIsIkdBTExFUllfUE9QVVAiLCJUSFVNQk5BSUxTIiwicXVlcnlTZWxlY3RvckFsbCIsInByZXZJbWdCdG4iLCJkb3dubG9hZEJ0biIsImV2ZW50IiwiZG93bmxvYWRBbGxCdG4iLCJjdXJyZW50SW1hZ2VJbmRleCIsImltYWdlc0FycmF5IiwiYmVoYXZpb3IiLCJ3aW5kb3ciLCJzaG93R2FsbGVyeSIsImNsYXNzTGlzdCIsImJvZHkiLCJzdHlsZSIsIm92ZXJmbG93Iiwic2Nyb2xsQnkiLCJpbm5lckhlaWdodCIsInNob3dJbWFnZUJ5SW5kZXgiLCJzZXRUaW1lb3V0IiwiY2xvc2VQb3B1cCIsImFkZCIsImlubmVySFRNTCIsInRodW1ibmFpbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiaW5kZXgiLCJmb3JFYWNoIiwiYXBwZW5kQ2hpbGQiLCJhZGRJdGVtVG9HYWxsZXJ5IiwibmV3SXRlbSIsImNyZWF0ZUVsZW1lbnQiLCJzcmMiLCJuZXh0SW1nQnRuIiwicHJldkltZyIsInBhcmFtcyIsImxlbmd0aCIsInN0YXJ0WCIsIm5leHRJbWciLCJrZXkiLCJvcGVuUG9wdXAiLCJNT0RBTF9DT05GSVJNIiwidG91Y2hlcyIsImNsaWVudFgiLCJzaG93Q29uZmlybSIsImZpbGVJbnB1dCIsInVwbG9hZEZvcm0iLCJwcmV2ZW50RGVmYXVsdCIsIl9zdGVwIiwicmVtb3ZlIiwicmVhZGVyIiwidXJsSW1hZ2UiLCJ0YXJnZXQiLCJjb25zb2xlIiwibmV3SW1nIiwiX2l0ZXJhdG9yIiwicyIsIm4iLCJkb25lIiwiRmlsZVJlYWRlciIsInB1c2giLCJzaG93QWxsRG93bmxvYWRCdG4iLCJyZXN1bHQiLCJyZWFkQXNEYXRhVVJMIiwiZmlsZSIsImVyciIsImFsdCIsImluZGV4T2YiLCJkb3dubG9hZEN1cnJlbnRJbWFnZSIsImxpbmsiLCJmIiwiZG93bmxvYWQiLCJ2YWx1ZSIsImltZ05hbWUiLCJjdXJyZW50SW1hZ2UiLCJkb3dubG9hZEdhbGxlcnlBc1ppcCIsImltYWdlIiwiaW1nRGF0YSIsInJlcGxhY2UiLCJ6aXAiLCJiYXNlNjQiLCJ0eXBlIiwiY2xpY2siLCJzYXZlQXMiLCJibG9iIiwicmVtb3ZlQ2hpbGQiLCJlcnJvciIsImJ1dHRvbnNBcnJheSIsImJ1dHRvbiIsInNldEF0dHJpYnV0ZSIsImNvbmNhdCIsImdlbmVyYXRlQXN5bmMiLCJzaG93R2FsbGVyeUluZm8iLCJnYWxsZXJ5SW5mbyIsIm9wZW5TY2hlZHVsZUJ0biIsIm9wZW5JbmZvQnRuIiwiY29udGFpbnMiLCJkaXNwbGF5Il0sIm1hcHBpbmdzIjoib29DQUFBLElBTU1BLGtCQU5BQyxRQUFVQyxTQUFTQyxlQUFlLFNBQVMsRUFDM0NDLGVBQWlCRixTQUFTQyxlQUFlLGdCQUFnQixFQUN6REUscUJBQXVCSCxTQUFTSSxjQUFjLDJCQUEyQixFQUN6RUMsd0JBQTBCTCxTQUFTSSxjQUFjLHdCQUF3QixFQUN6RUUsY0FBZ0JOLFNBQVNJLGNBQWMsaUJBQWlCLEVBSnhETCxXQUFVQyxTQUFTQyxpQkFBZSwrQkFBVSxFQUM1Q0MsY0FBaUJGLFNBQVNDLGNBQWUsMkJBQWlCLEVBQzFERSxXQUFBQSxTQUF1QkgsY0FBU0ksZUFBYyxFQUM5Q0MsV0FBQUEsU0FBdUJELGNBQVlBLGVBQWMsRUFDakRFLFlBQWdCTixTQUFTSSxjQUFjLGVBQUEsRUFDdkNHLGVBQWFQLFNBQVNRLGNBQWlCLDRCQUErQixFQUV0RUMsWUFBYVQsR0FFYlUsWUFBY1YsU0FBQUEsR0FDcEJXLEVBQU1DLGVBQWlCWixFQUN2QkQsUUFBSWMsVUFBQUEsSUFBaUIsY0FBQSxFQUNyQmQsUUFBSWUsZUFBZ0IsQ0FBQUMsU0FBQSxRQUFBLENBQUEsRUFFcEJDLE9B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LEdBQ3RCLElBQU0wRCxFQUFjbkcsU0FBU0ksY0FBYyxnQkFBZ0IsRUFDdkRVLFlBQVk0QixRQUFVLEVBQ3hCeUQsRUFBWS9FLE1BQU1tRixRQUFVLFFBRTVCSixFQUFZL0UsTUFBTW1GLFFBQVUsTUFFaEMsRUFDQUwsZ0JBQWdCIiwiZmlsZSI6ImdhbGxlcnkubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2FsbGVyeSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnYWxsZXJ5JylcclxuY29uc3Qgc2hvd0dhbGxlcnlCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0dhbGxlcnlidG4nKVxyXG5jb25zdCBUSFVNQk5BSUxTX0NPTlRBSU5FUiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5X190aHVtYm5haWxzLWxpc3QnKVxyXG5jb25zdCBQT1BVUF9HQUxMRVJZX0NPTlRBSU5FUiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc3dpcGVyLXdyYXBwZXInKVxyXG5jb25zdCBHQUxMRVJZX1BPUFVQID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19nYWxsZXJ5JylcclxuY29uc3QgVEhVTUJOQUlMUyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5nYWxsZXJ5X190aHVtYm5haWxzLWltZy1pdGVtJylcclxuY29uc3QgQ0xPU0VfR0FMTEVSWSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZ2FsbGVyeS1idG4tY2xvc2UnKVxyXG5jb25zdCBwcmV2SW1nQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZXYtaW1nLWJ0bicpXHJcbmNvbnN0IG5leHRJbWdCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV4dC1pbWctYnRuJylcclxuY29uc3QgZG93bmxvYWRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZG93bmxvYWQtYnRuJylcclxuY29uc3QgZG93bmxvYWRBbGxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeV9fYnRuLWRvd25sb2FkLWFsbCcpXHJcbmxldCBjdXJyZW50SW1hZ2VJbmRleFxyXG5sZXQgaW1hZ2VzQXJyYXkgPSBbXVxyXG5cclxuY29uc3Qgc2hvd0dhbGxlcnkgPSBldmVudCA9PiB7XHJcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG4gIGdhbGxlcnkuY2xhc3NMaXN0LmFkZCgnc2hvdy1nYWxsZXJ5JylcclxuICBnYWxsZXJ5LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnIH0pXHJcbiAgd2luZG93LnNjcm9sbEJ5KDAsIHdpbmRvdy5pbm5lckhlaWdodClcclxufVxyXG5zaG93R2FsbGVyeUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dHYWxsZXJ5KVxyXG5cclxuY29uc3Qgb3BlblBvcHVwID0gKCkgPT4ge1xyXG4gIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJ1xyXG4gIEdBTExFUllfUE9QVVAuY2xhc3NMaXN0LmFkZCgnc2hvdy1wb3B1cCcpXHJcbiAgc2hvd0ltYWdlQnlJbmRleChjdXJyZW50SW1hZ2VJbmRleClcclxufVxyXG5cclxuY29uc3QgY2xvc2VQb3B1cCA9ICgpID0+IHtcclxuICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2F1dG8nXHJcbiAgR0FMTEVSWV9QT1BVUC5jbGFzc0xpc3QuYWRkKCdmYWRlLW91dCcpXHJcbiAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICBHQUxMRVJZX1BPUFVQLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctcG9wdXAnKVxyXG4gICAgR0FMTEVSWV9QT1BVUC5jbGFzc0xpc3QucmVtb3ZlKCdmYWRlLW91dCcpXHJcbiAgICBQT1BVUF9HQUxMRVJZX0NPTlRBSU5FUi5pbm5lckhUTUwgPSAnJ1xyXG4gIH0sIDMwMClcclxufVxyXG5cclxuVEhVTUJOQUlMUy5mb3JFYWNoKCh0aHVtYm5haWwsIGluZGV4KSA9PiB7XHJcbiAgdGh1bWJuYWlsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XHJcbiAgICBjdXJyZW50SW1hZ2VJbmRleCA9IGluZGV4XHJcbiAgICBvcGVuUG9wdXAoKVxyXG4gIH0pXHJcbn0pXHJcblxyXG5DTE9TRV9HQUxMRVJZLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VQb3B1cClcclxuXHJcbmNvbnN0IGFkZEl0ZW1Ub0dhbGxlcnkgPSBpdGVtID0+IHtcclxuICBQT1BVUF9HQUxMRVJZX0NPTlRBSU5FUi5hcHBlbmRDaGlsZChpdGVtKVxyXG59XHJcbmNvbnN0IHNob3dJbWFnZUJ5SW5kZXggPSBpbmRleCA9PiB7XHJcbiAgUE9QVVBfR0FMTEVSWV9DT05UQUlORVIuaW5uZXJIVE1MID0gJydcclxuICBjb25zdCBuZXdJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJylcclxuICBuZXdJdGVtLnNyYyA9IGltYWdlc0FycmF5W2luZGV4XS5zcmNcclxuICBuZXdJdGVtLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX19zd2lwZXItaW1nJylcclxuICBwcmV2SW1nQnRuLmNsYXNzTGlzdC5hZGQoJ3ByZXYtaW1nLWJ0bicsICdpbWctYnRuJylcclxuICBuZXh0SW1nQnRuLmNsYXNzTGlzdC5hZGQoJ25leHQtaW1nLWJ0bicsICdpbWctYnRuJylcclxuICBhZGRJdGVtVG9HYWxsZXJ5KHByZXZJbWdCdG4pXHJcbiAgYWRkSXRlbVRvR2FsbGVyeShuZXh0SW1nQnRuKVxyXG4gIGFkZEl0ZW1Ub0dhbGxlcnkobmV3SXRlbSlcclxufVxyXG5cclxuY29uc3QgcHJldkltZyA9IHBhcmFtcyA9PiB7XHJcbiAgY3VycmVudEltYWdlSW5kZXggPVxyXG4gICAgKGN1cnJlbnRJbWFnZUluZGV4IC0gMSArIGltYWdlc0FycmF5Lmxlbmd0aCkgJSBpbWFnZXNBcnJheS5sZW5ndGhcclxuICBzaG93SW1hZ2VCeUluZGV4KGN1cnJlbnRJbWFnZUluZGV4KVxyXG59XHJcblxyXG5jb25zdCBuZXh0SW1nID0gKCkgPT4ge1xyXG4gIGN1cnJlbnRJbWFnZUluZGV4ID0gKGN1cnJlbnRJbWFnZUluZGV4ICsgMSkgJSBpbWFnZXNBcnJheS5sZW5ndGhcclxuICBzaG93SW1hZ2VCeUluZGV4KGN1cnJlbnRJbWFnZUluZGV4KVxyXG59XHJcbnByZXZJbWdCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwcmV2SW1nKVxyXG5cclxubmV4dEltZ0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG5leHRJbWcpXHJcblxyXG5kb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldmVudCA9PiB7XHJcbiAgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93TGVmdCcpIHtcclxuICAgIHByZXZJbWcoKVxyXG4gIH0gZWxzZSBpZiAoZXZlbnQua2V5ID09PSAnQXJyb3dSaWdodCcpIHtcclxuICAgIG5leHRJbWcoKVxyXG4gIH0gZWxzZSBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xyXG4gICAgY2xvc2VQb3B1cCgpXHJcbiAgfSBlbHNlIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHtcclxuICAgIG9wZW5Qb3B1cCgpXHJcbiAgfVxyXG59KVxyXG5cclxubGV0IHN0YXJ0WCA9IG51bGxcclxuXHJcblBPUFVQX0dBTExFUllfQ09OVEFJTkVSLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBlID0+IHtcclxuICBzdGFydFggPSBlLnRvdWNoZXNbMF0uY2xpZW50WFxyXG59KVxyXG5cclxuUE9QVVBfR0FMTEVSWV9DT05UQUlORVIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZSA9PiB7XHJcbiAgaWYgKCFzdGFydFgpIHJldHVyblxyXG4gIGNvbnN0IG1vdmVtZW50WCA9IGUudG91Y2hlc1swXS5jbGllbnRYIC0gc3RhcnRYXHJcbiAgaWYgKG1vdmVtZW50WCA+IDEwKSB7XHJcbiAgICBwcmV2SW1nKClcclxuICB9IGVsc2UgaWYgKG1vdmVtZW50WCA8IC0xMCkge1xyXG4gICAgbmV4dEltZygpXHJcbiAgfVxyXG59KVxyXG5cclxuUE9QVVBfR0FMTEVSWV9DT05UQUlORVIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XHJcbiAgc3RhcnRYID0gbnVsbFxyXG59KVxyXG5cclxuY29uc3QgTU9EQUxfQ09ORklSTSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY29uZmlybScpXHJcblxyXG5jb25zdCBzaG93Q29uZmlybSA9ICgpID0+IHtcclxuICBNT0RBTF9DT05GSVJNLmNsYXNzTGlzdC5hZGQoJ21vZGFsX19jb25maXJtLWFjdGl2ZScpXHJcbiAgc2V0VGltZW91dChoaWRlQ29uZmlybSwgMTAwMClcclxufVxyXG5cclxuY29uc3QgaGlkZUNvbmZpcm0gPSAoKSA9PiB7XHJcbiAgTU9EQUxfQ09ORklSTS5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbF9fY29uZmlybS1hY3RpdmUnKVxyXG59XHJcblxyXG4vL0ZPUk1cclxuY29uc3QgdXBsb2FkRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cGxvYWRGb3JtJylcclxuY29uc3QgZmlsZUlucHV0ID0gdXBsb2FkRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFt0eXBlPVwiZmlsZVwiXScpXHJcblxyXG51cGxvYWRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGV2ZW50ID0+IHtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXHJcblxyXG4gIGNvbnN0IGZpbGVzID0gZmlsZUlucHV0LmZpbGVzXHJcblxyXG4gIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xyXG4gICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxyXG5cclxuICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICBjb25zdCB1cmxJbWFnZSA9IGUudGFyZ2V0LnJlc3VsdFxyXG5cclxuICAgICAgY29uc3QgbmV3SW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJylcclxuICAgICAgbmV3SW1nLmNsYXNzTGlzdC5hZGQoJ2dhbGxlcnlfX3RodW1ibmFpbHMtaW1nLWl0ZW0nKVxyXG4gICAgICBuZXdJbWcuc3JjID0gdXJsSW1hZ2VcclxuICAgICAgbmV3SW1nLmFsdCA9IGBNYWdpY3puZSBDaHdpbGUgaW1hZ2UgJHtpbWFnZXNBcnJheS5sZW5ndGh9YFxyXG4gICAgICBUSFVNQk5BSUxTX0NPTlRBSU5FUi5hcHBlbmRDaGlsZChuZXdJbWcpXHJcblxyXG4gICAgICBuZXdJbWcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgY3VycmVudEltYWdlSW5kZXggPSBpbWFnZXNBcnJheS5pbmRleE9mKG5ld0ltZylcclxuICAgICAgICBvcGVuUG9wdXAoKVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgaW1hZ2VzQXJyYXkucHVzaChuZXdJbWcpXHJcbiAgICAgIHNob3dBbGxEb3dubG9hZEJ0bigpXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpXHJcbiAgfVxyXG4gIHNob3dDb25maXJtKClcclxuXHJcbiAgZmlsZUlucHV0LnZhbHVlID0gJydcclxufSlcclxuXHJcbi8vIFBvcHJhd2lvbmEgZnVua2NqYSBwb2JpZXJhbmlhIG9iZWNuZWdvIHpkasSZY2lhXHJcbmNvbnN0IGRvd25sb2FkQ3VycmVudEltYWdlID0gKCkgPT4ge1xyXG4gIGNvbnN0IGN1cnJlbnRJbWFnZSA9XHJcbiAgICBQT1BVUF9HQUxMRVJZX0NPTlRBSU5FUi5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3N3aXBlci1pbWcnKVxyXG5cclxuICBjb25zdCBpbWFnZU5hbWUgPSBgTWFnaWN6bmUgQ2h3aWxlIGltYWdlICR7Y3VycmVudEltYWdlSW5kZXh9YFxyXG5cclxuICBpZiAoY3VycmVudEltYWdlICYmIGN1cnJlbnRJbWFnZS5zcmMpIHtcclxuICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJylcclxuICAgIGxpbmsuaHJlZiA9IGN1cnJlbnRJbWFnZS5zcmNcclxuICAgIGxpbmsuZG93bmxvYWQgPSBgJHtpbWFnZU5hbWV9LmpwZ2BcclxuICAgIGxpbmsudGFyZ2V0ID0gJ19ibGFuaydcclxuXHJcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspXHJcblxyXG4gICAgbGluay5jbGljaygpXHJcblxyXG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKVxyXG4gIH0gZWxzZSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFxyXG4gICAgICAnTmllIG1vxbxuYSBwb2JyYcSHIG9iZWNuZWdvIG9icmF6dSAtIGJyYWsgb2JyYXp1IGx1YiBhZHJlcyBVUkwuJ1xyXG4gICAgKVxyXG4gIH1cclxufVxyXG5cclxuZG93bmxvYWRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkb3dubG9hZEN1cnJlbnRJbWFnZSlcclxuXHJcbmNvbnN0IGRvd25sb2FkR2FsbGVyeUFzWmlwID0gKCkgPT4ge1xyXG4gIGNvbnN0IHppcCA9IG5ldyBKU1ppcCgpXHJcblxyXG4gIGltYWdlc0FycmF5LmZvckVhY2goKGltYWdlLCBpbmRleCkgPT4ge1xyXG4gICAgY29uc3QgaW1nTmFtZSA9IGBpbWFnZV8ke2luZGV4ICsgMX0uanBnYFxyXG4gICAgY29uc3QgaW1nRGF0YSA9IGltYWdlLnNyYy5yZXBsYWNlKC9eZGF0YTppbWFnZVxcLyhwbmd8anBnfGpwZWcpO2Jhc2U2NCwvLCAnJylcclxuXHJcbiAgICB6aXAuZmlsZShpbWdOYW1lLCBpbWdEYXRhLCB7IGJhc2U2NDogdHJ1ZSB9KVxyXG4gIH0pXHJcblxyXG4gIHppcFxyXG4gICAgLmdlbmVyYXRlQXN5bmMoeyB0eXBlOiAnYmxvYicgfSlcclxuICAgIC50aGVuKGJsb2IgPT4ge1xyXG4gICAgICBzYXZlQXMoYmxvYiwgJ01hZ2ljem5lX0Nod2lsZV9nYWxlcmlhLnppcCcpXHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcignV3lzdMSFcGnFgiBixYLEhWQgcG9kY3phcyBnZW5lcm93YW5pYSBwbGlrdSBaSVA6JywgZXJyb3IpXHJcbiAgICB9KVxyXG59XHJcblxyXG5kb3dubG9hZEFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRvd25sb2FkR2FsbGVyeUFzWmlwKVxyXG5cclxuY29uc3Qgb3BlbkluZm9CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaW5mb0J0bicpXHJcbmNvbnN0IG9wZW5TY2hlZHVsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzY2hlZHVsZUJ0bicpXHJcblxyXG5sZXQgYnV0dG9uc0FycmF5ID0gW1xyXG4gIGZpbGVJbnB1dCxcclxuICB1cGxvYWRGb3JtLFxyXG4gIHNob3dHYWxsZXJ5QnRuLFxyXG4gIGRvd25sb2FkQWxsQnRuLFxyXG4gIG9wZW5JbmZvQnRuLFxyXG4gIG9wZW5TY2hlZHVsZUJ0bixcclxuXVxyXG5idXR0b25zQXJyYXkuZm9yRWFjaChidXR0b24gPT4ge1xyXG4gIGlmIChHQUxMRVJZX1BPUFVQLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1wb3B1cCcpKSB7XHJcbiAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpXHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKVxyXG4gIH1cclxufSlcclxuXHJcbmNvbnN0IHNob3dBbGxEb3dubG9hZEJ0biA9ICgpID0+IHtcclxuICBpZiAoaW1hZ2VzQXJyYXkubGVuZ3RoID4gMCkge1xyXG4gICAgZG93bmxvYWRBbGxCdG4uc3R5bGUuZGlzcGxheSA9ICdmbGV4J1xyXG4gIH0gZWxzZSB7XHJcbiAgICBkb3dubG9hZEFsbEJ0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXHJcbiAgfVxyXG4gIHNob3dHYWxsZXJ5SW5mbygpXHJcbn1cclxuXHJcbmNvbnN0IHNob3dHYWxsZXJ5SW5mbyA9IHBhcmFtcyA9PiB7XHJcbiAgY29uc3QgZ2FsbGVyeUluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeV9faW5mbycpXHJcbiAgaWYgKGltYWdlc0FycmF5Lmxlbmd0aCA8PSAwKSB7XHJcbiAgICBnYWxsZXJ5SW5mby5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJ1xyXG4gIH0gZWxzZSB7XHJcbiAgICBnYWxsZXJ5SW5mby5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXHJcbiAgfVxyXG59XHJcbnNob3dHYWxsZXJ5SW5mbygpIl19
