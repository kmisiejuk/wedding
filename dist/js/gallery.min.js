"use strict";function _createForOfIteratorHelper(e,t){var n,r,o,a,l="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(l)return r=!(n=!0),{s:function(){l=l.call(e)},n:function(){var e=l.next();return n=e.done,e},e:function(e){r=!0,o=e},f:function(){try{n||null==l.return||l.return()}finally{if(r)throw o}}};if(Array.isArray(e)||(l=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return l&&(e=l),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var currentImageIndex,gallery=document.getElementById("gallery"),showGalleryBtn=document.getElementById("showGallerybtn"),THUMBNAILS_CONTAINER=document.querySelector(".gallery__thumbnails-list"),POPUP_GALLERY_CONTAINER=document.querySelector(".popup__swiper-wrapper"),GALLERY_POPUP=document.querySelector(".popup__gallery"),THUMBNAILS=document.querySelectorAll(".gallery__thumbnails-img-item"),CLOSE_GALLERY=document.querySelector(".popup__gallery-btn-close"),prevImgBtn=document.querySelector(".prev-img-btn"),nextImgBtn=document.querySelector(".next-img-btn"),downloadBtn=document.querySelector(".download-btn"),downloadAllBtn=document.querySelector(".gallery__btn-download-all"),imagesArray=[],showGallery=function(e){e.preventDefault(),gallery.classList.add("show-gallery"),gallery.scrollIntoView({behavior:"smooth"}),window.scrollBy(0,window.innerHeight)},openPopup=(showGalleryBtn.addEventListener("click",showGallery),function(){document.body.style.overflow="hidden",GALLERY_POPUP.classList.add("show-popup"),showImageByIndex(currentImageIndex)}),closePopup=function(){document.body.style.overflow="auto",GALLERY_POPUP.classList.add("fade-out"),setTimeout(function(){GALLERY_POPUP.classList.remove("show-popup"),GALLERY_POPUP.classList.remove("fade-out"),POPUP_GALLERY_CONTAINER.innerHTML=""},300)},addItemToGallery=(THUMBNAILS.forEach(function(e,t){e.addEventListener("click",function(e){currentImageIndex=t,openPopup()})}),CLOSE_GALLERY.addEventListener("click",closePopup),function(e){POPUP_GALLERY_CONTAINER.appendChild(e)}),showImageByIndex=function(e){POPUP_GALLERY_CONTAINER.innerHTML="";var t=document.createElement("img");t.src=imagesArray[e].src,t.classList.add("popup__swiper-img"),prevImgBtn.classList.add("prev-img-btn","img-btn"),nextImgBtn.classList.add("next-img-btn","img-btn"),addItemToGallery(prevImgBtn),addItemToGallery(nextImgBtn),addItemToGallery(t)},prevImg=function(e){currentImageIndex=(currentImageIndex-1+imagesArray.length)%imagesArray.length,showImageByIndex(currentImageIndex)},nextImg=function(){currentImageIndex=(currentImageIndex+1)%imagesArray.length,showImageByIndex(currentImageIndex)},startX=(prevImgBtn.addEventListener("click",prevImg),nextImgBtn.addEventListener("click",nextImg),document.body.addEventListener("keydown",function(e){"ArrowLeft"===e.key?prevImg():"ArrowRight"===e.key?nextImg():"Escape"===e.key?closePopup():"Enter"===e.key&&openPopup()}),null),MODAL_CONFIRM=(POPUP_GALLERY_CONTAINER.addEventListener("touchstart",function(e){startX=e.touches[0].clientX}),POPUP_GALLERY_CONTAINER.addEventListener("touchmove",function(e){startX&&(10<(e=e.touches[0].clientX-startX)?prevImg():e<-10&&nextImg())}),POPUP_GALLERY_CONTAINER.addEventListener("touchend",function(){startX=null}),document.querySelector(".modal__confirm")),showConfirm=function(){MODAL_CONFIRM.classList.add("modal__confirm-active"),setTimeout(hideConfirm,1e3)},hideConfirm=function(){MODAL_CONFIRM.classList.remove("modal__confirm-active")},uploadForm=document.getElementById("uploadForm"),fileInput=uploadForm.querySelector('input[type="file"]'),downloadCurrentImage=(uploadForm.addEventListener("submit",function(e){e.preventDefault();var t,n=_createForOfIteratorHelper(fileInput.files);try{for(n.s();!(t=n.n()).done;){var r=t.value,o=new FileReader;o.onload=function(e){var e=e.target.result,t=document.createElement("img");t.classList.add("gallery__thumbnails-img-item"),t.src=e,t.alt="Magiczne Chwile image ".concat(imagesArray.length),THUMBNAILS_CONTAINER.appendChild(t),t.addEventListener("click",function(){currentImageIndex=imagesArray.indexOf(t),openPopup()}),imagesArray.push(t)},o.readAsDataURL(r)}}catch(e){n.e(e)}finally{n.f()}showConfirm(),fileInput.value=""}),function(){var e,t=POPUP_GALLERY_CONTAINER.querySelector(".popup__swiper-img"),n="Magiczne Chwile image ".concat(currentImageIndex);t&&t.src?((e=document.createElement("a")).href=t.src,e.download="".concat(n,".jpg"),e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)):console.error("Nie można pobrać obecnego obrazu - brak obrazu lub adres URL.")}),downloadGalleryAsZip=(downloadBtn.addEventListener("click",downloadCurrentImage),function(){var n=new JSZip;imagesArray.forEach(function(e,t){t="image_".concat(t+1,".jpg"),e=e.src.replace(/^data:image\/(png|jpg|jpeg);base64,/,"");n.file(t,e,{base64:!0})}),n.generateAsync({type:"blob"}).then(function(e){saveAs(e,"Magiczne_Chwile_galeria.zip")}).catch(function(e){console.error("Wystąpił błąd podczas generowania pliku ZIP:",e)})}),openInfoBtn=(downloadAllBtn.addEventListener("click",downloadGalleryAsZip),document.querySelector("#infoBtn")),openScheduleBtn=document.querySelector("#scheduleBtn"),buttonsArray=[fileInput,uploadForm,showGalleryBtn,downloadAllBtn,openInfoBtn,openScheduleBtn];buttonsArray.forEach(function(e){GALLERY_POPUP.classList.contains("show-popup")?e.setAttribute("tabindex","-1"):e.setAttribute("tabindex","0")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdhbGxlcnkuanMiXSwibmFtZXMiOlsiQ0xPU0VfR0FMTEVSWSIsImdhbGxlcnkiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic2hvd0dhbGxlcnlCdG4iLCJUSFVNQk5BSUxTX0NPTlRBSU5FUiIsInF1ZXJ5U2VsZWN0b3IiLCJQT1BVUF9HQUxMRVJZX0NPTlRBSU5FUiIsIkdBTExFUllfUE9QVVAiLCJUSFVNQk5BSUxTIiwicXVlcnlTZWxlY3RvckFsbCIsInByZXZJbWdCdG4iLCJkb3dubG9hZEJ0biIsImRvd25sb2FkQWxsQnRuIiwiY3VycmVudEltYWdlSW5kZXgiLCJhZGQiLCJpbWFnZXNBcnJheSIsImJlaGF2aW9yIiwic2hvd0dhbGxlcnkiLCJ3aW5kb3ciLCJldmVudCIsImNsYXNzTGlzdCIsImJvZHkiLCJzdHlsZSIsIm92ZXJmbG93IiwiaW5uZXJIZWlnaHQiLCJzaG93SW1hZ2VCeUluZGV4Iiwic2V0VGltZW91dCIsImNsb3NlUG9wdXAiLCJyZW1vdmUiLCJpbm5lckhUTUwiLCJ0aHVtYm5haWwiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImluZGV4IiwiYWRkSXRlbVRvR2FsbGVyeSIsImFwcGVuZENoaWxkIiwibmV3SXRlbSIsImNyZWF0ZUVsZW1lbnQiLCJzcmMiLCJuZXh0SW1nQnRuIiwicHJldkltZyIsInBhcmFtcyIsImxlbmd0aCIsInN0YXJ0WCIsIm5leHRJbWciLCJrZXkiLCJvcGVuUG9wdXAiLCJNT0RBTF9DT05GSVJNIiwidG91Y2hlcyIsImNsaWVudFgiLCJzaG93Q29uZmlybSIsImZpbGVJbnB1dCIsInVwbG9hZEZvcm0iLCJwcmV2ZW50RGVmYXVsdCIsIl9zdGVwIiwicmVhZGVyIiwidXJsSW1hZ2UiLCJ0YXJnZXQiLCJsaW5rIiwibmV3SW1nIiwiX2l0ZXJhdG9yIiwiX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIiLCJmaWxlcyIsInMiLCJuIiwiZG9uZSIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJyZXN1bHQiLCJyZWFkQXNEYXRhVVJMIiwiZmlsZSIsImVyciIsImFsdCIsImNvbmNhdCIsImluZGV4T2YiLCJ2YWx1ZSIsInB1c2giLCJkb3dubG9hZEN1cnJlbnRJbWFnZSIsImltYWdlTmFtZSIsImYiLCJjdXJyZW50SW1hZ2UiLCJkb3dubG9hZEdhbGxlcnlBc1ppcCIsImhyZWYiLCJKU1ppcCIsImRvd25sb2FkIiwiaW1hZ2UiLCJpbWdOYW1lIiwiaW1nRGF0YSIsImNsaWNrIiwiZ2VuZXJhdGVBc3luYyIsInJlbW92ZUNoaWxkIiwidGhlbiIsImVycm9yIiwiYmxvYiIsImJ1dHRvbnNBcnJheSIsImZvckVhY2giLCJidXR0b24iLCJzZXRBdHRyaWJ1dGUiLCJyZXBsYWNlIiwiemlwIiwiYmFzZTY0IiwidHlwZSIsInNhdmVBcyIsImNvbnNvbGUiLCJvcGVuSW5mb0J0biIsIm9wZW5TY2hlZHVsZUJ0biIsImNvbnRhaW5zIl0sIm1hcHBpbmdzIjoib29DQUFBLElBTU1BLGtCQU5BQyxRQUFVQyxTQUFTQyxlQUFlLFNBQVMsRUFDM0NDLGVBQWlCRixTQUFTQyxlQUFlLGdCQUFnQixFQUN6REUscUJBQXVCSCxTQUFTSSxjQUFjLDJCQUEyQixFQUN6RUMsd0JBQTBCTCxTQUFTSSxjQUFjLHdCQUF3QixFQUN6RUUsY0FBZ0JOLFNBQVNJLGNBQWMsaUJBQWlCLEVBSnhETCxXQUFVQyxTQUFTQyxpQkFBZSwrQkFBVSxFQUM1Q0MsY0FBaUJGLFNBQVNDLGNBQWUsMkJBQWlCLEVBQzFERSxXQUFBQSxTQUF1QkgsY0FBU0ksZUFBYyxFQUM5Q0MsV0FBQUEsU0FBdUJELGNBQVlBLGVBQWMsRUFDakRFLFlBQWdCTixTQUFTSSxjQUFjLGVBQUEsRUFDdkNHLGVBQWFQLFNBQVNRLGNBQWlCLDRCQUErQixFQUV0RUMsWUFBYVQsR0FFYlUsWUFBY1YsU0FBQUEsR0FDZFcsRUFBQUEsZUFBaUJYLEVBQ25CWSxRQUFBQSxVQUFpQkMsSUFBQSxjQUFBLEVBQ2pCQyxRQUFBQSxlQUFnQixDQUFBQyxTQUFBLFFBQUEsQ0FBQSxFQUVk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LEVBRzVDQyxTQUFBQSxLQUFjQyxZQUFBaEMsQ0FBQSxHQUNiaUMsUUFBS0MsTUFDS0MsK0RBQ1QsQ0FsQlYsR0E0QklDLHNCQUpKbEYsWUFBQUEsaUJBQWVtQixRQUFpQjhDLG9CQUFTSSxFQUs1QixXQU9iYSxJQUFBQSxFQUFhQyxJQUFPWixNQUVaYSxZQUFPQyxRQUFhLFNBQUFaLEVBQUFwRCxHQUNqQnFELEVBQUEsU0FBQWIsT0FBQXhDLEVBQUEsRUFBQSxNQUFBLEVBQ0lnRSxFQUFhWixFQUFBL0MsSUFBVTRELFFBQU0sc0NBQUEsRUFBQSxFQUUxQ0MsRUFBQTdCLEtBQUFnQixFQUFBQyxFQUFBLENBQUFhLE9BQUEsQ0FBQSxDQUFBLENBQUEsQ0E3QkUsQ0FBQyxFQUVERCxFQUFJVixjQUFjLENBQUVZLEtBQU0sTUFBTyxDQUFDLEVBQzdCVixLQUFLLFNBQUFFLEdBQ0ZTLE9BQU9ULEVBQU0sNkJBQTZCLENBQzlDLENBQUMsRUFBQyxNQUNLLFNBQUFELEdBQ0hXLFFBQVFYLE1BQU0sK0NBQWdEQSxDQUFLLENBQ3ZFLENBQUMsQ0FDVCxHQUdNWSxhQURONUYsZUFBZW1CLGlCQUFpQixRQUFTa0Qsb0JBQW9CLEVBQ3pDaEYsU0FBU0ksY0FBYyxVQUFVLEdBQy9Db0csZ0JBQWtCeEcsU0FBU0ksY0FBYyxjQUFjLEVBRXpEeUYsYUFBZSxDQUNmM0MsVUFDQUMsV0FDQWpELGVBQ0FTLGVBQ0E0RixZQUNBQyxpQkFFSlgsYUFBYUMsUUFBUSxTQUFBQyxHQUNiekYsY0FBY2EsVUFBVXNGLFNBQVMsWUFBWSxFQUM3Q1YsRUFBT0MsYUFBYSxXQUFZLElBQUksRUFFcENELEVBQU9DLGFBQWEsV0FBWSxHQUFHLENBRTNDLENBQUMiLCJmaWxlIjoiZ2FsbGVyeS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBnYWxsZXJ5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbGxlcnknKTtcclxuY29uc3Qgc2hvd0dhbGxlcnlCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0dhbGxlcnlidG4nKTtcclxuY29uc3QgVEhVTUJOQUlMU19DT05UQUlORVIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeV9fdGh1bWJuYWlscy1saXN0Jyk7XHJcbmNvbnN0IFBPUFVQX0dBTExFUllfQ09OVEFJTkVSID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19zd2lwZXItd3JhcHBlcicpO1xyXG5jb25zdCBHQUxMRVJZX1BPUFVQID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19nYWxsZXJ5Jyk7XHJcbmNvbnN0IFRIVU1CTkFJTFMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ2FsbGVyeV9fdGh1bWJuYWlscy1pbWctaXRlbScpO1xyXG5jb25zdCBDTE9TRV9HQUxMRVJZID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19nYWxsZXJ5LWJ0bi1jbG9zZScpO1xyXG5jb25zdCBwcmV2SW1nQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZXYtaW1nLWJ0bicpO1xyXG5jb25zdCBuZXh0SW1nQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5leHQtaW1nLWJ0bicpO1xyXG5jb25zdCBkb3dubG9hZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kb3dubG9hZC1idG4nKTtcclxuY29uc3QgZG93bmxvYWRBbGxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeV9fYnRuLWRvd25sb2FkLWFsbCcpO1xyXG5sZXQgY3VycmVudEltYWdlSW5kZXg7XHJcbmxldCBpbWFnZXNBcnJheSA9IFtdO1xyXG5cclxuY29uc3Qgc2hvd0dhbGxlcnkgPSBldmVudCA9PiB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgZ2FsbGVyeS5jbGFzc0xpc3QuYWRkKCdzaG93LWdhbGxlcnknKTtcclxuICAgIGdhbGxlcnkuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcgfSk7XHJcbiAgICB3aW5kb3cuc2Nyb2xsQnkoMCwgd2luZG93LmlubmVySGVpZ2h0KTtcclxufTtcclxuc2hvd0dhbGxlcnlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzaG93R2FsbGVyeSk7XHJcblxyXG5jb25zdCBvcGVuUG9wdXAgPSAoKSA9PiB7XHJcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XHJcbiAgICBHQUxMRVJZX1BPUFVQLmNsYXNzTGlzdC5hZGQoJ3Nob3ctcG9wdXAnKTtcclxuICAgIHNob3dJbWFnZUJ5SW5kZXgoY3VycmVudEltYWdlSW5kZXgpO1xyXG59O1xyXG5cclxuY29uc3QgY2xvc2VQb3B1cCA9ICgpID0+IHtcclxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnYXV0byc7XHJcbiAgICBHQUxMRVJZX1BPUFVQLmNsYXNzTGlzdC5hZGQoJ2ZhZGUtb3V0Jyk7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBHQUxMRVJZX1BPUFVQLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctcG9wdXAnKTtcclxuICAgICAgICBHQUxMRVJZX1BPUFVQLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhZGUtb3V0Jyk7XHJcbiAgICAgICAgUE9QVVBfR0FMTEVSWV9DT05UQUlORVIuaW5uZXJIVE1MID0gJyc7XHJcbiAgICB9LCAzMDApO1xyXG59O1xyXG5cclxuVEhVTUJOQUlMUy5mb3JFYWNoKCh0aHVtYm5haWwsIGluZGV4KSA9PiB7XHJcbiAgICB0aHVtYm5haWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcclxuICAgICAgICBjdXJyZW50SW1hZ2VJbmRleCA9IGluZGV4O1xyXG4gICAgICAgIG9wZW5Qb3B1cCgpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuQ0xPU0VfR0FMTEVSWS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlUG9wdXApO1xyXG5cclxuY29uc3QgYWRkSXRlbVRvR2FsbGVyeSA9IGl0ZW0gPT4ge1xyXG4gICAgUE9QVVBfR0FMTEVSWV9DT05UQUlORVIuYXBwZW5kQ2hpbGQoaXRlbSk7XHJcbn07XHJcbmNvbnN0IHNob3dJbWFnZUJ5SW5kZXggPSBpbmRleCA9PiB7XHJcbiAgICBQT1BVUF9HQUxMRVJZX0NPTlRBSU5FUi5pbm5lckhUTUwgPSAnJztcclxuICAgIGNvbnN0IG5ld0l0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICAgIG5ld0l0ZW0uc3JjID0gaW1hZ2VzQXJyYXlbaW5kZXhdLnNyYztcclxuICAgIG5ld0l0ZW0uY2xhc3NMaXN0LmFkZCgncG9wdXBfX3N3aXBlci1pbWcnKTtcclxuICAgIHByZXZJbWdCdG4uY2xhc3NMaXN0LmFkZCgncHJldi1pbWctYnRuJywgJ2ltZy1idG4nKTtcclxuICAgIG5leHRJbWdCdG4uY2xhc3NMaXN0LmFkZCgnbmV4dC1pbWctYnRuJywgJ2ltZy1idG4nKTtcclxuICAgIGFkZEl0ZW1Ub0dhbGxlcnkocHJldkltZ0J0bik7XHJcbiAgICBhZGRJdGVtVG9HYWxsZXJ5KG5leHRJbWdCdG4pO1xyXG4gICAgYWRkSXRlbVRvR2FsbGVyeShuZXdJdGVtKTtcclxufTtcclxuXHJcbmNvbnN0IHByZXZJbWcgPSBwYXJhbXMgPT4ge1xyXG4gICAgY3VycmVudEltYWdlSW5kZXggPVxyXG4gICAgICAgIChjdXJyZW50SW1hZ2VJbmRleCAtIDEgKyBpbWFnZXNBcnJheS5sZW5ndGgpICUgaW1hZ2VzQXJyYXkubGVuZ3RoO1xyXG4gICAgc2hvd0ltYWdlQnlJbmRleChjdXJyZW50SW1hZ2VJbmRleCk7XHJcbn07XHJcblxyXG5jb25zdCBuZXh0SW1nID0gKCkgPT4ge1xyXG4gICAgY3VycmVudEltYWdlSW5kZXggPSAoY3VycmVudEltYWdlSW5kZXggKyAxKSAlIGltYWdlc0FycmF5Lmxlbmd0aDtcclxuICAgIHNob3dJbWFnZUJ5SW5kZXgoY3VycmVudEltYWdlSW5kZXgpO1xyXG59O1xyXG5wcmV2SW1nQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcHJldkltZyk7XHJcblxyXG5uZXh0SW1nQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbmV4dEltZyk7XHJcblxyXG5kb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldmVudCA9PiB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSAnQXJyb3dMZWZ0Jykge1xyXG4gICAgICAgIHByZXZJbWcoKTtcclxuICAgIH0gZWxzZSBpZiAoZXZlbnQua2V5ID09PSAnQXJyb3dSaWdodCcpIHtcclxuICAgICAgICBuZXh0SW1nKCk7XHJcbiAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgICBjbG9zZVBvcHVwKCk7XHJcbiAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykge1xyXG4gICAgICAgIG9wZW5Qb3B1cCgpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbmxldCBzdGFydFggPSBudWxsO1xyXG5cclxuUE9QVVBfR0FMTEVSWV9DT05UQUlORVIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGUgPT4ge1xyXG4gICAgc3RhcnRYID0gZS50b3VjaGVzWzBdLmNsaWVudFg7XHJcbn0pO1xyXG5cclxuUE9QVVBfR0FMTEVSWV9DT05UQUlORVIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZSA9PiB7XHJcbiAgICBpZiAoIXN0YXJ0WCkgcmV0dXJuO1xyXG4gICAgY29uc3QgbW92ZW1lbnRYID0gZS50b3VjaGVzWzBdLmNsaWVudFggLSBzdGFydFg7XHJcbiAgICBpZiAobW92ZW1lbnRYID4gMTApIHtcclxuICAgICAgICBwcmV2SW1nKCk7XHJcbiAgICB9IGVsc2UgaWYgKG1vdmVtZW50WCA8IC0xMCkge1xyXG4gICAgICAgIG5leHRJbWcoKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5QT1BVUF9HQUxMRVJZX0NPTlRBSU5FUi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcclxuICAgIHN0YXJ0WCA9IG51bGw7XHJcbn0pO1xyXG5cclxuY29uc3QgTU9EQUxfQ09ORklSTSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY29uZmlybScpO1xyXG5cclxuY29uc3Qgc2hvd0NvbmZpcm0gPSAoKSA9PiB7XHJcbiAgICBNT0RBTF9DT05GSVJNLmNsYXNzTGlzdC5hZGQoJ21vZGFsX19jb25maXJtLWFjdGl2ZScpO1xyXG4gICAgc2V0VGltZW91dChoaWRlQ29uZmlybSwgMTAwMCk7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlQ29uZmlybSA9ICgpID0+IHtcclxuICAgIE1PREFMX0NPTkZJUk0uY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWxfX2NvbmZpcm0tYWN0aXZlJyk7XHJcbn07XHJcblxyXG4vL0ZPUk1cclxuY29uc3QgdXBsb2FkRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cGxvYWRGb3JtJyk7XHJcbmNvbnN0IGZpbGVJbnB1dCA9IHVwbG9hZEZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1cImZpbGVcIl0nKTtcclxuXHJcbnVwbG9hZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZXZlbnQgPT4ge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGZpbGVzID0gZmlsZUlucHV0LmZpbGVzO1xyXG5cclxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xyXG4gICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblxyXG4gICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBjb25zdCB1cmxJbWFnZSA9IGUudGFyZ2V0LnJlc3VsdDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0ltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgICAgICAgICBuZXdJbWcuY2xhc3NMaXN0LmFkZCgnZ2FsbGVyeV9fdGh1bWJuYWlscy1pbWctaXRlbScpO1xyXG4gICAgICAgICAgICBuZXdJbWcuc3JjID0gdXJsSW1hZ2U7XHJcbiAgICAgICAgICAgIG5ld0ltZy5hbHQgPSBgTWFnaWN6bmUgQ2h3aWxlIGltYWdlICR7aW1hZ2VzQXJyYXkubGVuZ3RofWA7XHJcbiAgICAgICAgICAgIFRIVU1CTkFJTFNfQ09OVEFJTkVSLmFwcGVuZENoaWxkKG5ld0ltZyk7XHJcblxyXG4gICAgICAgICAgICBuZXdJbWcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50SW1hZ2VJbmRleCA9IGltYWdlc0FycmF5LmluZGV4T2YobmV3SW1nKTtcclxuICAgICAgICAgICAgICAgIG9wZW5Qb3B1cCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGltYWdlc0FycmF5LnB1c2gobmV3SW1nKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTtcclxuICAgIH1cclxuICAgIHNob3dDb25maXJtKCk7XHJcbiAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcclxufSk7XHJcblxyXG4vLyBQb3ByYXdpb25hIGZ1bmtjamEgcG9iaWVyYW5pYSBvYmVjbmVnbyB6ZGrEmWNpYVxyXG5jb25zdCBkb3dubG9hZEN1cnJlbnRJbWFnZSA9ICgpID0+IHtcclxuICAgIGNvbnN0IGN1cnJlbnRJbWFnZSA9XHJcbiAgICAgICAgUE9QVVBfR0FMTEVSWV9DT05UQUlORVIucXVlcnlTZWxlY3RvcignLnBvcHVwX19zd2lwZXItaW1nJyk7XHJcblxyXG4gICAgY29uc3QgaW1hZ2VOYW1lID0gYE1hZ2ljem5lIENod2lsZSBpbWFnZSAke2N1cnJlbnRJbWFnZUluZGV4fWA7XHJcblxyXG4gICAgaWYgKGN1cnJlbnRJbWFnZSAmJiBjdXJyZW50SW1hZ2Uuc3JjKSB7XHJcbiAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgICAgICBsaW5rLmhyZWYgPSBjdXJyZW50SW1hZ2Uuc3JjO1xyXG4gICAgICAgIGxpbmsuZG93bmxvYWQgPSBgJHtpbWFnZU5hbWV9LmpwZ2A7XHJcbiAgICAgICAgbGluay50YXJnZXQgPSAnX2JsYW5rJztcclxuXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTtcclxuXHJcbiAgICAgICAgbGluay5jbGljaygpO1xyXG5cclxuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFxyXG4gICAgICAgICAgICAnTmllIG1vxbxuYSBwb2JyYcSHIG9iZWNuZWdvIG9icmF6dSAtIGJyYWsgb2JyYXp1IGx1YiBhZHJlcyBVUkwuJ1xyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5kb3dubG9hZEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRvd25sb2FkQ3VycmVudEltYWdlKTtcclxuXHJcblxyXG5jb25zdCBkb3dubG9hZEdhbGxlcnlBc1ppcCA9ICgpID0+IHtcclxuICAgIGNvbnN0IHppcCA9IG5ldyBKU1ppcCgpO1xyXG5cclxuICAgIGltYWdlc0FycmF5LmZvckVhY2goKGltYWdlLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGltZ05hbWUgPSBgaW1hZ2VfJHtpbmRleCArIDF9LmpwZ2A7XHJcbiAgICAgICAgY29uc3QgaW1nRGF0YSA9IGltYWdlLnNyYy5yZXBsYWNlKC9eZGF0YTppbWFnZVxcLyhwbmd8anBnfGpwZWcpO2Jhc2U2NCwvLCAnJyk7XHJcblxyXG4gICAgICAgIHppcC5maWxlKGltZ05hbWUsIGltZ0RhdGEsIHsgYmFzZTY0OiB0cnVlIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgemlwLmdlbmVyYXRlQXN5bmMoeyB0eXBlOiAnYmxvYicgfSlcclxuICAgICAgICAudGhlbihibG9iID0+IHtcclxuICAgICAgICAgICAgc2F2ZUFzKGJsb2IsICdNYWdpY3puZV9DaHdpbGVfZ2FsZXJpYS56aXAnKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1d5c3TEhXBpxYIgYsWCxIVkIHBvZGN6YXMgZ2VuZXJvd2FuaWEgcGxpa3UgWklQOicsIGVycm9yKTtcclxuICAgICAgICB9KTtcclxufTtcclxuXHJcbmRvd25sb2FkQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZG93bmxvYWRHYWxsZXJ5QXNaaXApO1xyXG5jb25zdCBvcGVuSW5mb0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNpbmZvQnRuJyk7XHJcbmNvbnN0IG9wZW5TY2hlZHVsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzY2hlZHVsZUJ0bicpO1xyXG5cclxubGV0IGJ1dHRvbnNBcnJheSA9IFtcclxuICAgIGZpbGVJbnB1dCxcclxuICAgIHVwbG9hZEZvcm0sXHJcbiAgICBzaG93R2FsbGVyeUJ0bixcclxuICAgIGRvd25sb2FkQWxsQnRuLFxyXG4gICAgb3BlbkluZm9CdG4sXHJcbiAgICBvcGVuU2NoZWR1bGVCdG4sXHJcbl07XHJcbmJ1dHRvbnNBcnJheS5mb3JFYWNoKGJ1dHRvbiA9PiB7XHJcbiAgICBpZiAoR0FMTEVSWV9QT1BVUC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3ctcG9wdXAnKSkge1xyXG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTtcclxuICAgIH1cclxufSk7Il19
